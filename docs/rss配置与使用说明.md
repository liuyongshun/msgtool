## RSS æŠ“å–ä¸æœ¬åœ°æ•°æ®åº“è¯´æ˜

### 1. åŠŸèƒ½æ¦‚è§ˆ

- **æ•°æ®æ¥æº**ï¼š`config/sources.json` ä¸­é…ç½®çš„ä¸€ç»„ RSS æºï¼ˆç§‘æŠ€åª’ä½“ã€å…¬å¸åšå®¢ã€Newsletter ç­‰ï¼‰ã€‚
- **æ ¸å¿ƒç›®æ ‡**ï¼š
  - èšåˆå¤šæº AI / ç§‘æŠ€ç›¸å…³æ–‡ç« ï¼›
  - é€šè¿‡ LLM å¯¹æ–‡ç« æ ‡é¢˜åšç›¸å…³æ€§ç­›é€‰ï¼›
  - å¯é€‰å¯¹æ ‡é¢˜/æ‘˜è¦åšç¿»è¯‘ï¼›
  - å°†ç»“æœæŒ‰å¤©å†™å…¥ `output/daily/YYYY-MM-DD/rss_*.json`ï¼Œå¹¶å¯é€‰åŒæ­¥åˆ° Notionã€‚

---

### 2. é…ç½®å…¥å£

#### 2.1 RSS æºé…ç½®

- **ä½ç½®**ï¼š`config/sources.json` â†’ `sources.rss`
- **å•ä¸ªæºé…ç½®ç¤ºä¾‹**ï¼š

```jsonc
"rss": {
  "mit_tech_review": {
    "enabled": true,
    "name": "MIT Technology Review AI",
    "url": "https://www.technologyreview.com/feed/",
    "description": "MITç§‘æŠ€è¯„è®ºAIé¢‘é“",
    "category": "technology_news",
    "tags": ["AIèµ„è®¯", "æŠ€æœ¯åšå®¢"],
    "ai_filter_enabled": true,
    "translation_enabled": false
  }
}
```

- **å­—æ®µå«ä¹‰**ï¼š
  - **`enabled`**ï¼šæ˜¯å¦å¯ç”¨è¯¥ RSS æºã€‚
  - **`name`**ï¼šç”¨äºå‰ç«¯å±•ç¤ºå’Œæ—¥å¿—è¾“å‡ºçš„åç§°ã€‚
  - **`url`**ï¼šRSS è®¢é˜…åœ°å€ã€‚
  - **`category`**ï¼šè‡ªå®šä¹‰åˆ†ç±»æ ‡ç­¾ï¼ˆå¦‚ `news` / `newsletter` / `trends` ç­‰ï¼Œä¸»è¦ç”¨äºæ–‡æ¡£å’Œåç»­æ‰©å±•ï¼‰ã€‚
  - **`tags`**ï¼šå¯¹è¯¥æºçš„å›ºå®šæ ‡ç­¾ï¼ˆä¾‹å¦‚ `["AIèµ„è®¯","æŠ€æœ¯åšå®¢"]`ï¼‰ï¼Œä¼šé™„åŠ åœ¨æ–‡ç« ä¸Šã€‚
  - **`ai_filter_enabled`**ï¼š
    - `true`ï¼šå¯¹è¯¥æºæŠ“åˆ°çš„æ–‡ç« æ ‡é¢˜ä½¿ç”¨ LLM åšä¸€æ¬¡ã€Œæ˜¯å¦ä¸ AI / ç§‘æŠ€ç›¸å…³ã€çš„ç­›é€‰ï¼›
    - `false`ï¼šä¸è°ƒç”¨ LLMï¼Œæ‰€æœ‰æŠ“åˆ°çš„æ–‡ç« éƒ½ä¿ç•™ã€‚
  - **`translation_enabled`**ï¼š
    - `true`ï¼šå¯¹ç­›é€‰åçš„æ–‡ç« æ ‡é¢˜å’Œæ‘˜è¦è°ƒç”¨ç¿»è¯‘ï¼›
    - `false`ï¼šåªä¿ç•™åŸæ–‡ã€‚

> **æ¨èç­–ç•¥ï¼š**
> - å¯¹ä¿¡å™ªæ¯”è¾ƒé«˜ã€ä¸“æ³¨ AI çš„æºï¼Œå¯ä»¥è€ƒè™‘ `ai_filter_enabled=false`ï¼ŒèŠ‚çœ Tokenï¼›
> - å¯¹ç»¼åˆç§‘æŠ€åª’ä½“ï¼ˆTechCrunchã€Techmeme ç­‰ï¼‰ï¼Œå»ºè®®ä¿æŒ `ai_filter_enabled=true`ï¼›
> - ä¸­å›½åŒº / ä¸­æ–‡æºå¯ä»¥æŒ‰éœ€è¦å…³é—­ `translation_enabled`ã€‚

#### 2.2 è°ƒåº¦é…ç½®

- **ä½ç½®**ï¼š`config/sources.json` â†’ `settings.scheduler.tasks.rss`

```jsonc
"settings": {
  "scheduler": {
    "enabled": true,
    "tasks": {
      "rss": {
        "enabled": true,
        "time": ["10:20", "14:05", "17:20", "20:40"],
        "max_results": 20
      }
    }
  }
}
```

- **å­—æ®µå«ä¹‰**ï¼š
  - **`settings.scheduler.enabled`**ï¼šè°ƒåº¦å™¨æ€»å¼€å…³ã€‚
  - **`tasks.rss.enabled`**ï¼šæ˜¯å¦å¯ç”¨ RSS å®šæ—¶ä»»åŠ¡ã€‚
  - **`tasks.rss.time`**ï¼šæ¯å¤©æ‰§è¡Œçš„æ—¶é—´ç‚¹ï¼ˆå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ï¼‰ã€‚
  - **`tasks.rss.max_results`**ï¼šå•æ¬¡æ¯ä¸ªæºæœ€å¤šæŠ“å–å¤šå°‘æ¡æ–‡ç« ã€‚

> **è¯´æ˜**ï¼š
> - å®šæ—¶ä»»åŠ¡ä¸ä¼šåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼Œè‹¥è¦ç«‹å³æ‰§è¡Œï¼Œä»éœ€ä½¿ç”¨ `--once`ã€‚

---

### 3. è¿è¡Œæ–¹å¼

#### 3.1 ä¸€æ¬¡æ€§æ‰§è¡Œï¼ˆæ‰‹åŠ¨åˆ·æ–°ï¼‰

```bash
python3 src/msgskill/multi_scheduler.py --once
```

- ä¼šæ‰§è¡Œæ‰€æœ‰ `enabled=true` çš„ä»»åŠ¡ï¼Œå…¶ä¸­åŒ…æ‹¬ RSSã€‚
- RSS æµç¨‹ï¼š
  - ä»é…ç½®ä¸­è¯»å–æ‰€æœ‰å¯ç”¨æºçš„ URLï¼›
  - å¯¹æ¯ä¸ªæºè°ƒç”¨ `fetch_rss_feeds` æŠ“å– + LLM ç­›é€‰ + ç¿»è¯‘ï¼›
  - æŒ‰å¤©å†™å…¥/è¿½åŠ åˆ° `output/daily/YYYY-MM-DD/rss_*.json`ï¼›
  - å¯é€‰åŒæ­¥æ–°å¢æ–‡ç« åˆ° Notionï¼ˆå¦‚æœé…ç½®äº† notion_sync ä¸”å¯ç”¨ï¼‰ã€‚

#### 3.2 é•¿æœŸå®šæ—¶è¿è¡Œ

- ä½¿ç”¨ `start.sh` å¯åŠ¨è°ƒåº¦å™¨åå°å¾ªç¯ï¼š
  - ç”± `settings.scheduler.enabled` + `tasks.rss.enabled` æ§åˆ¶æ˜¯å¦å¯ç”¨ï¼›
  - æ¯å¤©åœ¨ `tasks.rss.time` æŒ‡å®šçš„æ—¶é—´ç‚¹æ‰§è¡Œä¸€æ¬¡ RSS åŒæ­¥ã€‚

---

### 4. æ•°æ®ç»“æ„è¯´æ˜ï¼š`output/daily/YYYY-MM-DD/rss_*.json`

- **æ–‡ä»¶å‘½å**ï¼š`rss_YYYYMMDD_HHMMSS.json`
- **ç»“æ„ç¤ºä¾‹ï¼ˆç²¾ç®€ç‰ˆï¼‰**ï¼š

```jsonc
{
  "source": "RSS Feeds",
  "feeds_count": 27,
  "total_items": 247,
  "errors_count": 3,
  "fetched_at": "2026-02-10T10:20:53",
  "feeds": {
    "https://www.technologyreview.com/feed/": {
      "url": "https://www.technologyreview.com/feed/",
      "title": "MIT Technology Review AI",
      "description": "...",
      "link": "https://www.technologyreview.com/",
      "updated": "...",
      "items_count": 20,
      "items": [
        {
          "title": "...",
          "link": "https://www.technologyreview.com/...",
          "summary": "...",
          "published": "Mon, 10 Feb 2026 02:28:48 GMT",
          "author": "ä½œè€…å",
          "tags": ["AIèµ„è®¯"],
          "ai_score": 0.87
        }
      ]
    }
  },
  "errors": [
    "æŸäº›æºçš„æŠ“å–/è§£æé”™è¯¯ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰"
  ]
}
```

#### 4.1 è¿½åŠ ä¸å»é‡é€»è¾‘

- åŒä¸€å¤©å¤šæ¬¡åŒæ­¥æ—¶ï¼š
  - å§‹ç»ˆåœ¨åŒä¸€ä¸ª `rss_*.json` æ–‡ä»¶å†…è¿½åŠ ï¼›
  - å¯¹**åŒä¸€ä¸ª feed** ä¸‹çš„æ–‡ç« ï¼ŒæŒ‰ `link` å»é‡ï¼ˆåŒä¸€é“¾æ¥åªä¿ç•™ä¸€æ¡ï¼‰ã€‚
- `preview_server` çš„ `/api/data/<date>/rss` ä¼šï¼š
  - åˆå¹¶åŒä¸€å¤©çš„æ‰€æœ‰ `rss_*.json`ï¼›
  - æŒ‰ feed èšåˆï¼Œç»Ÿè®¡ `feeds_count` ä¸ `total_items`ï¼›
  - æä¾›ç»™å‰ç«¯ `renderRssData` æ¸²æŸ“ã€‚

---

### 5. LLM ä¸ç¿»è¯‘è¡Œä¸º

- **AI ç­›é€‰ï¼ˆ`ai_filter_enabled`ï¼‰**ï¼š
  - å½“æŸä¸ªæºå¯ç”¨ AI ç­›é€‰æ—¶ï¼Œæœ¬è½®æŠ“åˆ°çš„æ–‡ç« æ ‡é¢˜ä¼šæ‰“åŒ…é€å…¥ `classify_titles_batch`ï¼›
  - åªä¿ç•™ `keep=true` çš„æ–‡ç« ï¼Œå¹¶åœ¨æ¡ç›®ä¸Šå†™å…¥ `ai_score`ï¼›
  - æ—¥å¿—ä¸­å¯è§ï¼š
    - `å¼€å§‹AIç­›é€‰ N ç¯‡æ–‡ç« ...`
    - `AIç­›é€‰å®Œæˆ: N -> M ç¯‡æ–‡ç« `ã€‚
- **ç¿»è¯‘ï¼ˆ`translation_enabled`ï¼‰**ï¼š
  - å¯¹é€šè¿‡ AI ç­›é€‰çš„æ–‡ç« ï¼ˆæˆ–æœªå¯ç”¨ AI ç­›é€‰æ—¶çš„æ‰€æœ‰æ–‡ç« ï¼‰å¹¶å‘è°ƒç”¨ `translate_article_item`ï¼›
  - ç”¨ç¿»è¯‘åçš„æ ‡é¢˜ä¸æ‘˜è¦è¦†ç›–åŸå§‹å€¼ï¼›
  - è‹¥ç¿»è¯‘å¤±è´¥ï¼Œä¼šä¿ç•™åŸæ–‡ã€‚
- **ç¼“å­˜æœºåˆ¶**ï¼š
  - æ¯ä¸ªæºæŒ‰ `rss_{url}_{limit}_t{0/1}` åš 10 åˆ†é’Ÿç¼“å­˜ï¼ˆ`t1` è¡¨ç¤ºå¼€å¯ç¿»è¯‘ï¼Œ`t0` è¡¨ç¤ºå…³é—­ç¿»è¯‘ï¼‰ï¼›
  - ç¼“å­˜ key åŒºåˆ† `translation_enabled` çŠ¶æ€ï¼Œé¿å…ç¿»è¯‘ç»“æœå’Œæœªç¿»è¯‘ç»“æœç›¸äº’æ±¡æŸ“ï¼›
  - 10 åˆ†é’Ÿå†…é‡å¤è°ƒç”¨ï¼Œä¸ä¼šå†æ¬¡è¯·æ±‚ HTTP å’Œ LLMï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ç¼“å­˜ç»“æœã€‚

> å½“å‰ RSS æš‚æœªåƒ GitHub é‚£æ ·åšã€Œè·¨å¤© LLM ç»“æœå¤ç”¨ã€ï¼Œæ‰€ä»¥åŒä¸€ç¯‡æ–‡ç« è·¨å¤©å†æ¬¡æŠ“å–æ—¶ï¼Œä¼šé‡æ–°è·‘ä¸€æ¬¡ AI ç­›é€‰ï¼ˆä½†æ¯æ¬¡åªå¯¹â€œæ–°æŠ“åˆ°â€çš„ N æ¡æ–‡ç« è°ƒç”¨ä¸€æ¬¡ LLMï¼‰ã€‚

---

### 6. Notion åŒæ­¥å…³ç³»

- é…ç½®ï¼š`config/sources.json` â†’ `notion_sync` æ®µä¸­çš„ `databases.rss.database_id`ã€‚
- é€»è¾‘ï¼ˆåœ¨ `multi_scheduler.sync_rss()` ä¸­ï¼‰ï¼š
  - å½“å¤©å·²æœ‰ RSS æ–‡ä»¶ï¼š
    - å–è¿™æ¬¡æ–°å¢çš„ `new_items`ï¼Œè°ƒç”¨ `_sync_rss_items_to_notion(new_items)`ï¼›
  - å½“å¤©ç¬¬ä¸€æ‰¹ï¼š
    - åˆå¹¶æ‰€æœ‰ `feeds[*].items`ï¼Œä¸€æ¬¡æ€§è°ƒç”¨ `_sync_rss_items_to_notion(all_items)`ã€‚
- `_sync_rss_items_to_notion` ä¼šæŠŠæ¯æ¡ RSS item è½¬æˆ `ArticleItem`ï¼Œå¹¶é€šè¿‡ `NotionSync.sync_items(..., skip_existing=true)`ï¼š
  - åŸºäº `source_url`ï¼ˆä¹Ÿå°±æ˜¯ RSS çš„ `link`ï¼‰åœ¨ Notion ä¸­æŸ¥é‡ï¼›
  - å·²å­˜åœ¨é¡µé¢ä¸ä¼šé‡å¤åˆ›å»ºã€‚

---

### 7. è°ƒæ•´ä¸ä¼˜åŒ–å»ºè®®ï¼ˆç®€è¦ï¼‰

- **æƒ³å¤šä¸€ç‚¹ RSS å†…å®¹**ï¼š
  - æé«˜ `tasks.rss.max_results`ï¼›
  - å¯ç”¨æ›´å¤šæºï¼ˆ`sources.rss.*.enabled=true`ï¼‰ã€‚
- **æƒ³å‡å°‘ Token æ¶ˆè€—**ï¼š
  - å¯¹çº¯ AI æºï¼ˆä¾‹å¦‚ deep-learning Newsletterï¼‰å…³é—­ `ai_filter_enabled`ï¼›
  - åªå¯¹â€œæ³›ç§‘æŠ€æ–°é—»â€ç±»æºä¿ç•™ AI ç­›é€‰ï¼›
  - æŒ‰éœ€å…³é—­ `translation_enabled`ï¼Œæ”¹ä¸ºåªä¿ç•™åŸæ–‡ã€‚
- **è°ƒè¯•é—®é¢˜æ—¶**ï¼š
  - æŸ¥çœ‹ `logs/scheduler_clean.log` ä¸­çš„ RSS æ—¥å¿—ï¼š
    - æŠ“å–ï¼š`ğŸ“º å¼€å§‹åŒæ­¥RSSè®¢é˜… - æœ€å¤š...`ã€`åŒæ­¥ N ä¸ªRSSæº`
    - AIï¼š`å¼€å§‹AIç­›é€‰...`ã€`AIç­›é€‰å®Œæˆ...`
    - è½ç›˜ï¼š`âœ…/âš ï¸ RSSåŒæ­¥å®Œæˆ/éƒ¨åˆ†å¤±è´¥: ... | è¾“å‡º: rss_*.json`

